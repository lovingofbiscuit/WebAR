<!DOCTYPE html>
<html>
  <head>
    <title>AR без маркера</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
    <script>
      AFRAME.registerComponent('place-on-plane', {
        init: function () {
          const el = this.el;
          const sceneEl = document.querySelector('a-scene');
          
          sceneEl.addEventListener('click', function (event) {
            const touch = event.touches ? event.touches[0] : event;
            const touchPoint = new THREE.Vector2();
            touchPoint.x = (touch.clientX / window.innerWidth) * 2 - 1;
            touchPoint.y = - (touch.clientY / window.innerHeight) * 2 + 1;

            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(touchPoint, sceneEl.camera);
            const intersects = raycaster.intersectObjects(sceneEl.object3D.children, true);

            if (intersects.length > 0) {
              const intersect = intersects[0];
              el.setAttribute('position', intersect.point);
            }
          });
        }
      });
    </script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene vr-mode-ui="enabled: false" arjs="sourceType: webcam; debugUIEnabled: false;">
      <a-camera gps-camera rotation-reader></a-camera>
      <a-box place-on-plane position="0 0 -5" rotation="0 45 0" color="#4CC3D9"></a-box>
      <a-sphere place-on-plane position="0 1.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-cylinder place-on-plane position="1 0.75 -5" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
      <a-plane place-on-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>
      <a-sky color="#ECECEC"></a-sky>
    </a-scene>
  </body>
</html>
